  # Audiocast Music
  - alias: Livingroom Audiocast stopped
    trigger:
      - platform: state
        entity_id: media_player.living_room_audio
        to: 'off'
    condition:
      - condition: template
        value_template: "{{ is_state_attr('remote.livingroom_hub', 'current_activity', 'Music') }}"
    action:
      service: switch.turn_off
      entity_id: switch.livingroom_chromecast_audio
  - alias: Livingroom Audiocast playing
    trigger:
      - platform: state
        entity_id: media_player.living_room_audio
        to: 'playing'
      - platform: state
        entity_id: media_player.living_room_audio
        to: 'paused'
    condition:
      - condition: template
        value_template: "{{ is_state_attr('remote.livingroom_hub', 'current_activity', 'PowerOff') }}"
    action:
      service: switch.turn_on
      entity_id: switch.livingroom_chromecast_audio
  - alias: Livingroom Audiocast Still Playing
    trigger:
      platform: template
      value_template: "{% if is_state( 'media_player.living_room_audio', 'off')%}false{% else %}true{% endif %}"
    action:
      # Built in because of switch to use of webhooks which works asynchronously
      - wait_template: "{{ is_state_attr('remote.livingroom_hub', 'current_activity', 'Music') }}"
        timeout: '00:01:00'
        continue_on_timeout: 'true'
      - service: media_player.media_stop
        entity_id: media_player.living_room_audio
      - service: media_player.turn_off
        entity_id: media_player.living_room_audio

  # Chromecast
  - alias: Livingroom Chromecast stopped
    trigger:
      platform: state
      entity_id: media_player.living_room_video
      to: 'off'
    condition:
      - condition: template
        value_template: "{{ is_state_attr('remote.livingroom_hub', 'current_activity', 'Chromecast') }}"
    action:
      service: switch.turn_off
      entity_id: switch.livingroom_chromecast
  - alias: Livingroom Chromecast playing
    trigger:
      - platform: state
        entity_id: media_player.living_room_video
        to: 'playing'
      - platform: state
        entity_id: media_player.living_room_video
        to: 'paused'
    condition:
      - condition: template
        value_template: "{{ is_state_attr('remote.livingroom_hub', 'current_activity', 'PowerOff') }}"
    action:
      service: switch.turn_on
      entity_id: switch.livingroom_chromecast

  # Chromecast Audio Wireless Speakers
  - alias: Wireless Speakers Turned Off
    trigger:
      - platform: state
        entity_id: group.wireless_speakers
        to: 'off'
    action:
      - service: media_player.media_stop
        entity_id: media_player.wireless_speakers
      - service: media_player.turn_off
        entity_id: media_player.wireless_speakers

  # KODI
  - alias: Livingroom Kodi Start Playing
    trigger:
      platform: state
      entity_id: media_player.kodiliving
      to: 'playing'
    action:
      service: switch.turn_on
      entity_id: switch.livingroom_kodi
